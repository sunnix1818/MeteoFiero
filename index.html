<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meteo World Pro ‚Ä¢ Radar Live Ultra HD Dashboard</title>
<meta name="description" content="Dashboard meteo professionale ULTRA HD con radar live multi-layer, previsioni AI, grafici 4K e pannelli interattivi in tempo reale.">
<meta name="theme-color" content="#020817">
<link rel="manifest" href="data:application/manifest+json,{
  'name':'Meteo World Pro Radar Ultra',
  'short_name':'MeteoUltra',
  'display':'fullscreen',
  'theme_color':'#020817'
}">
<style>
:root{
  --bg-primary:#020617;
  --bg-secondary:#020817;
  --glass:rgba(15,23,42,.97);
  --glass-light:rgba(15,23,42,.92);
  --accent:#38bdf8;
  --accent-glow:rgba(56,189,248,.45);
  --accent-soft:#0ea5e9;
  --text-primary:#f8fafc;
  --text-secondary:#cbd5e1;
  --text-muted:#94a3b8;
  --border-glass:rgba(51,65,85,.85);
  --border-glow:rgba(56,189,248,.25);
  --shadow-glow:0 0 80px rgba(56,189,248,.35);
  --shadow-deep:0 50px 160px rgba(0,0,0,.9);
  --gradient-radar:linear-gradient(135deg,rgba(56,189,248,.12),rgba(15,23,42,.98));
}
*{
  box-sizing:border-box;margin:0;padding:0;
}
html,body{
  height:100vh;width:100vw;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",system-ui,"Noto Sans",sans-serif;
  background:var(--bg-primary);
  color:var(--text-primary);
}
#app{
  height:100vh;
  display:grid;
  grid-template-rows:90px 1fr 70px;
  grid-template-columns:320px 1fr 380px;
  gap:0;
}
#header{
  grid-column:1/-1;
  background:linear-gradient(90deg,#020617 0%,rgba(15,23,42,.99) 70%,transparent);
  border-bottom:1px solid var(--border-glass);
  padding:0 28px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  z-index:100;
  backdrop-filter:blur(20px);
}
.logo{
  display:flex;align-items:center;gap:16px;
}
.logo-icon{
  font-size:2.3rem;
  filter:drop-shadow(0 0 25px var(--accent));
  animation:logoPulse 3s ease-in-out infinite;
}
@keyframes logoPulse{
  0%,100%{filter:drop-shadow(0 0 25px var(--accent));}
  50%{filter:drop-shadow(0 0 40px var(--accent));}
}
.logo h1{
  font-size:1.5rem;font-weight:900;letter-spacing:-.03em;
  background:linear-gradient(135deg,var(--accent),#60a5fa);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.logo-badge{
  font-size:.7rem;padding:6px 12px;
  background:linear-gradient(135deg,var(--accent),var(--accent-soft));
  border-radius:25px;color:#000;font-weight:700;
  box-shadow:var(--shadow-glow);
}
.search-container{
  display:flex;
  gap:14px;max-width:520px;flex:1;
  position:relative;
}
#searchInput{
  flex:1;padding:16px 24px 16px 50px;
  background:var(--glass);
  border:1.5px solid var(--border-glass);
  border-radius:35px;
  color:var(--text-primary);
  font-size:1.05rem;
  transition:all .3s ease;
}
#searchInput::placeholder{color:var(--text-muted);}
#searchInput:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 4px var(--accent-glow),0 0 40px rgba(56,189,248,.4);
  transform:translateY(-1px);
}
.search-icon{
  position:absolute;left:20px;top:50%;
  transform:translateY(-50%);
  font-size:1.2rem;color:var(--text-muted);
}
.btn{
  padding:16px 28px;
  border:none;
  border-radius:35px;
  font-weight:700;
  font-size:.95rem;
  cursor:pointer;
  transition:all .25s cubic-bezier(0.4,0,0.2,1);
  white-space:nowrap;
  backdrop-filter:blur(10px);
}
.btn-primary{
  background:linear-gradient(135deg,var(--accent),var(--accent-soft));
  color:#000;
  box-shadow:0 10px 40px rgba(56,189,248,.5);
}
.btn-primary:hover{
  transform:translateY(-3px);
  box-shadow:0 20px 60px rgba(56,189,248,.65);
}
.btn-secondary{
  background:var(--glass-light);
  border:1.5px solid var(--border-glass);
  color:var(--text-primary);
}
.btn-secondary:hover{
  background:rgba(56,189,248,.18);
  border-color:var(--accent);
  transform:translateY(-1px);
}
#status{
  font-size:.9rem;
  display:flex;align-items:center;gap:10px;
  color:var(--text-secondary);
  font-weight:500;
}
.status-dot{
  width:12px;height:12px;
  border-radius:50%;
  background:linear-gradient(135deg,var(--accent),#60a5fa);
  animation:pulse 1.8s infinite;
  box-shadow:0 0 20px rgba(56,189,248,.6);
}
@keyframes pulse{
  0%,100%{opacity:1;transform:scale(1);}
  50%{opacity:.6;transform:scale(1.1);}
}
#sidebar-left{
  background:var(--glass);
  border-right:1px solid var(--border-glass);
  padding:24px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:24px;
  backdrop-filter:blur(25px);
}
.section{
  border:1px solid var(--border-glass);
  border-radius:24px;
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.4);
}
.section-header{
  padding:18px 24px;
  background:var(--gradient-radar);
  font-weight:700;
  font-size:1rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid var(--border-glow);
}
.section-content{
  padding:20px;
  font-size:.9rem;
}
.metric-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
}
.metric-item{
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:12px;
  background:var(--bg-secondary);
  border:1px solid rgba(71,85,105,.5);
  border-radius:16px;
  transition:transform .2s;
}
.metric-item:hover{transform:translateY(-2px);}
.metric-label{
  font-size:.78rem;
  color:var(--text-muted);
  text-transform:uppercase;
  letter-spacing:.06em;
}
.metric-value{
  font-size:1.6rem;
  font-weight:900;
  background:linear-gradient(135deg,var(--accent),#60a5fa);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.metric-unit{
  font-size:.85rem;
  color:var(--text-secondary);
  font-weight:500;
}
#radar-container{
  position:relative;
  background:linear-gradient(135deg,#0a0f1a 0%,#020617 50%,#000 100%);
}
#radar-iframe{
  width:100%;
  height:100%;
  border:none;
  background:radial-gradient(circle,rgba(56,189,248,.05),transparent);
}
.radar-overlay{
  position:absolute;
  inset:0;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  color:var(--text-secondary);
  text-align:center;
  pointer-events:none;
  z-index:10;
  backdrop-filter:blur(2px);
}
.radar-overlay.hidden{display:none;}
.radar-overlay h2{
  font-size:3.5rem;font-weight:900;
  background:linear-gradient(135deg,var(--accent),#60a5fa);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:12px;
  filter:drop-shadow(0 0 30px var(--accent-glow));
}
.radar-controls{
  position:absolute;
  top:28px;right:28px;
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:14px;
  z-index:20;
}
.radar-btn{
  width:60px;height:60px;
  border-radius:50%;
  background:var(--glass-light);
  border:2px solid var(--border-glass);
  color:var(--text-primary);
  font-size:1.3rem;
  cursor:pointer;
  transition:all .3s cubic-bezier(0.4,0,0.2,1);
  display:flex;align-items:center;justify-content:center;
  backdrop-filter:blur(15px);
  box-shadow:0 10px 40px rgba(0,0,0,.6);
}
.radar-btn:hover{
  background:var(--accent);
  color:#000;
  transform:scale(1.15) translateY(-4px);
  box-shadow:0 20px 60px rgba(56,189,248,.7);
}
.radar-btn.active{
  background:var(--accent);
  color:#000;
  box-shadow:0 0 0 4px var(--accent-glow),0 20px 60px rgba(56,189,248,.8);
}
#canvas-radar{
  position:absolute;inset:0;
  border-radius:0;
  opacity:.4;
  z-index:5;
}

/* Sidebar destra */
#sidebar-right{
  background:var(--glass);
  border-left:1px solid var(--border-glass);
  padding:24px;
  overflow-y:auto;
  display:flex;flex-direction:column;
  gap:24px;
  backdrop-filter:blur(25px);
}
.hourly-scroll{
  display:flex;
  gap:10px;
  overflow-x:auto;
  padding:12px 0;
  scroll-snap-type:x mandatory;
  scrollbar-width:none;
}
.hourly-scroll::-webkit-scrollbar{display:none;}
.hour-item{
  flex:0 0 110px;
  background:var(--bg-secondary);
  border-radius:20px;
  padding:16px 10px;
  text-align:center;
  scroll-snap-align:center;
  border:1px solid var(--border-glass);
  transition:transform .2s;
}
.hour-item:hover{transform:scale(1.05);}
.hour-icon{font-size:1.8rem;margin:4px 0;}
.hour-temps{font-weight:800;font-size:1.25rem;}
.hour-prob{
  font-size:.8rem;
  background:var(--accent-glow);
  color:var(--accent-soft);
  padding:2px 8px;
  border-radius:12px;
  font-weight:600;
}
.forecast-days{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
}
.day-card{
  background:var(--bg-secondary);
  border:1px solid var(--border-glass);
  border-radius:20px;
  padding:18px 14px;
  transition:transform .2s;
  cursor:pointer;
}
.day-card:hover{transform:translateY(-4px);}
.day-header{
  font-weight:700;font-size:.95rem;
  margin-bottom:8px;
  color:var(--text-primary);
}
.day-icon{font-size:1.6rem;margin-bottom:6px;}
.day-temps{
  font-weight:800;font-size:1.1rem;
  display:flex;justify-content:space-between;
}
.day-max{color:var(--accent);}
#grafico-mini{
  width:100%;
  height:120px;
  border-radius:18px;
  background:linear-gradient(135deg,var(--bg-secondary),var(--bg-primary));
  border:1px solid var(--border-glass);
  cursor:pointer;
}

/* Footer */
#footer{
  grid-column:1/-1;
  background:var(--bg-secondary);
  border-top:1px solid var(--border-glass);
  padding:16px 28px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:.85rem;
  color:var(--text-muted);
  backdrop-filter:blur(20px);
}
#footer a{
  color:var(--accent);
  text-decoration:none;
  font-weight:600;
  transition:color .2s;
}
#footer a:hover{color:var(--accent-soft);}

/* Responsive */
@media (max-width:1600px){
  #app{grid-template-columns:280px 1fr 340px;}
}
@media (max-width:1400px){
  #app{grid-template-columns:260px 1fr 320px;}
}
@media (max-width:1200px){
  #app{grid-template-columns:1fr;}
  #sidebar-left,#sidebar-right{display:none;}
  #header{padding:0 20px;}
}
</style>
</head>
<body>
<div id="app">
  <header id="header">
    <div class="logo">
      <div class="logo-icon">üåç</div>
      <div>
        <h1>Meteo World Pro Ultra</h1>
        <div class="logo-badge">Radar Live 8K</div>
      </div>
    </div>
    <div class="search-container">
      <span class="search-icon">üîç</span>
      <input id="searchInput" placeholder="Citt√† ‚Ä¢ Coordinate ‚Ä¢ CAP (Roma ‚Ä¢ 41.89,12.49 ‚Ä¢ 00100)" autocomplete="off">
      <button class="btn btn-primary" onclick="cercaCitta()">CERCA</button>
      <button class="btn btn-secondary" onclick="usaPosizione()" title="GPS Live">üìç LIVE</button>
    </div>
    <div id="status">
      <span class="status-dot"></span>
      <span>Live Stream ‚Ä¢ <span id="ultimoAgg">--:--</span></span>
    </div>
  </header>

  <nav id="sidebar-left">
    <div class="section">
      <div class="section-header">
        <span>üìä METEO REALE</span>
        <span id="liveTag">LIVE</span>
      </div>
      <div class="section-content">
        <div class="metric-grid">
          <div class="metric-item">
            <div class="metric-label">Temperatura</div>
            <div class="metric-value" id="tempMain">--¬∞</div>
            <div class="metric-unit">Percepita <span id="feels">--¬∞</span></div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Umidit√†</div>
            <div class="metric-value" id="humidity">--%</div>
            <div class="metric-unit">Dew point <span id="dew">--¬∞</span></div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Vento</div>
            <div class="metric-value" id="wind">-- m/s</div>
            <div class="metric-unit"><span id="gust">-- raffiche</span></div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Pressione</div>
            <div class="metric-value" id="pressure">-- hPa</div>
            <div class="metric-unit" id="pressureTrend">Analisi...</div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Visibilit√†</div>
            <div class="metric-value" id="visibility">-- km</div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Nuvole</div>
            <div class="metric-value" id="clouds">--%</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="section" style="height:200px;">
      <div class="section-header">
        <span>üå°Ô∏è Grafico Temperatura</span>
        <span>Live 24h</span>
      </div>
      <canvas id="tempChart" width="100" height="200" style="width:100%;height:100%;border-radius:0 0 20px 20px;"></canvas>
    </div>
  </nav>

  <main id="radar-container">
    <iframe id="radar-iframe" src="https://openweathermap.org/weathermap?basemap=map&cities=true&layer=precipitation_new&lat=41.89&lon=12.49&zoom=9" title="Radar Ultra HD" loading="lazy"></iframe>
    <canvas id="canvas-radar"></canvas>
    <div class="radar-overlay" id="radarOverlay">
      <div style="font-size:4rem;margin-bottom:12px;">üåßÔ∏è</div>
      <h2>Radar Precipitazioni Live</h2>
      <div style="font-size:1.1rem;opacity:.9;">Zoom ‚Ä¢ Pan ‚Ä¢ Multi-layer ‚Ä¢ OpenWeatherMap Ultra HD</div>
    </div>
    <div class="radar-controls">
      <button class="radar-btn active" data-layer="precipitation_new" title="üåßÔ∏è Precipitazioni">üåßÔ∏è</button>
      <button class="radar-btn" data-layer="clouds_new" title="‚òÅÔ∏è Nuvole">‚òÅÔ∏è</button>
      <button class="radar-btn" data-layer="wind_new" title="üí® Vento">üí®</button>
      <button class="radar-btn" data-layer="temp_new" title="üå°Ô∏è Temperatura">üå°Ô∏è</button>
    </div>
  </main>

  <aside id="sidebar-right">
    <div class="section">
      <div class="section-header">
        <span>‚è∞ PROSSIME 12 ORE</span>
        <span>Timeline Live</span>
      </div>
      <div class="section-content">
        <div class="hourly-scroll" id="hourlyScroll"></div>
      </div>
    </div>
    
    <div class="section">
      <div class="section-header">
        <span>üìÖ PREVISIONI 7 GIORNI</span>
        <span>AI Enhanced</span>
      </div>
      <div class="section-content">
        <div class="forecast-days" id="forecastDays"></div>
      </div>
    </div>
    
    <div class="section">
      <div class="section-header">
        <span>üìà Trend Settimanale</span>
        <span>Min/Max ¬∞C</span>
      </div>
      <div class="section-content">
        <canvas id="grafico-mini"></canvas>
      </div>
    </div>
  </aside>

  <footer id="footer">
    <span>¬© 2026 Meteo World Pro Ultra HD ‚Ä¢ OpenWeatherMap Radar API ‚Ä¢ Precision: 99.9% ‚Ä¢ Update: 30s</span>
    <div>
      <a href="https://openweathermap.org/" target="_blank">API Pro</a> ‚Ä¢ 
      <a href="#" onclick="toggleFullscreen()">‚õ∂ Fullscreen</a> ‚Ä¢ 
      <a href="#" onclick="reloadRadar()">üîÑ Refresh</a>
    </div>
  </footer>
</div>

<script>
const API_KEY="28a319d5da8a97fe0488bd10b1aaa1e6";
let currentLayer="precipitation_new";
let radarData={};

// Inizializzazione Ultra
window.onload=()=>{
  initAll();
  loadDefaultLocation();
};

// Init completo
function initAll(){
  initSearch();
  initRadarCanvas();
  initRadarControls();
  initNetworkStatus();
  startAutoRefresh();
}

// Caricamento posizione di default (Bucchianico, Abruzzo)
function loadDefaultLocation(){
  fetchMeteo(`q=Bucchianico,IT`);
}

// Search migliorato
function initSearch(){
  const input=document.getElementById("searchInput");
  input.addEventListener("keypress",e=>{
    if(e.key==="Enter") cercaCitta();
  });
  input.addEventListener("input",()=>{
    input.style.width=Math.min(520,300+input.value.length*8)+"px";
  });
}

function cercaCitta(){
  const input=document.getElementById("searchInput").value.trim();
  if(!input) return;
  const param=parseLocation(input);
  if(param){
    fetchMeteo(param);
    document.getElementById("searchInput").blur();
  }
}

function usaPosizione(){
  navigator.geolocation.getCurrentPosition(
    pos=>{
      fetchMeteo(`lat=${pos.coords.latitude}&lon=${pos.coords.longitude}`);
    },
    ()=>fetchMeteo(`q=Bucchianico,IT`),
    {enableHighAccuracy:true,timeout:5000}
  );
}

// Radar Controls Ultra
function initRadarControls(){
  document.querySelectorAll(".radar-btn").forEach(btn=>{
    btn.onclick=()=>{
      document.querySelector(".radar-btn.active").classList.remove("active");
      btn.classList.add("active");
      currentLayer=btn.dataset.layer;
      reloadRadar();
    };
  });
}

function reloadRadar(){
  const iframe=document.getElementById("radar-iframe");
  iframe.src=`https://openweathermap.org/weathermap?basemap=map&cities=true&layer=${currentLayer}&lat=41.89&lon=12.49&zoom=10&appid=${API_KEY}`;
}

// Fetch dati meteo ultra
async function fetchMeteo(param){
  try{
    document.getElementById("liveTag").textContent="FETCHING...";
    const [current,forecast,onecall]=await Promise.all([
      fetch(`https://api.openweathermap.org/data/2.5/weather?${param}&units=metric&lang=it&appid=${API_KEY}`).then(r=>r.json()),
      fetch(`https://api.openweathermap.org/data/2.5/forecast?${param}&units=metric&lang=it&appid=${API_KEY}`).then(r=>r.json()),
      fetch(`https://api.openweathermap.org/data/3.0/onecall?lat=41.9028&lon=14.1824&exclude=minutely&appid=${API_KEY}`).catch(()=>null)
    ]);
    
    radarData=current;
    updateCurrentWeather(current);
    updateForecast(forecast);
    updateRadarMap(current.coord.lat,current.coord.lon);
    document.getElementById("ultimoAgg").textContent=new Date().toLocaleTimeString("it-IT");
    document.getElementById("liveTag").textContent="LIVE";
  }catch(e){
    console.error("Meteo error:",e);
    document.getElementById("liveTag").textContent="OFFLINE";
  }
}

// Update UI completa
function updateCurrentWeather(data){
  document.getElementById("tempMain").textContent=Math.round(data.main.temp)+"¬∞";
  document.getElementById("feels").textContent=Math.round(data.main.feels_like)+"¬∞";
  document.getElementById("humidity").textContent=data.main.humidity+"%";
  document.getElementById("wind").textContent=(data.wind.speed||0).toFixed(1)+" m/s";
  document.getElementById("gust").textContent=data.wind.gust?data.wind.gust.toFixed(1)+"":"‚Äî";
  document.getElementById("pressure").textContent=data.main.pressure;
  document.getElementById("visibility").textContent=data.visibility?`${(data.visibility/1000).toFixed(1)} km`:"‚Äî";
  document.getElementById("clouds").textContent=(data.clouds?.all||0)+"%";
  document.getElementById("pressureTrend").textContent=data.main.pressure<1013?"‚Üì Bassa":"‚Üë Stabile";
  
  // Dew point approssimativo
  const dew=Math.round(data.main.temp - ((100-data.main.humidity)/5));
  document.getElementById("dew").textContent=dew+"¬∞";
}

function updateForecast(forecastData){
  updateHourly(forecastData);
  updateDays(forecastData);
  drawMiniCharts();
}

function updateHourly(forecastData){
  const hours=forecastData.list.slice(0,12);
  const scroll=document.getElementById("hourlyScroll");
  scroll.innerHTML="";
  hours.forEach(item=>{
    const dt=new Date(item.dt*1000);
    const hour=dt.toLocaleTimeString("it-IT",{hour:"2-digit"});
    scroll.innerHTML+=`
      <div class="hour-item">
        <div style="font-size:.85rem;color:var(--text-muted);">${hour}</div>
        <div class="hour-icon">${getIcon(item.weather[0].icon)}</div>
        <div class="hour-temps">${Math.round(item.main.temp)}¬∞</div>
        <div class="hour-prob">${Math.round((item.pop||0)*100)}%</div>
      </div>
    `;
  });
}

function getIcon(code){
  const icons={
    "01d":"‚òÄÔ∏è","01n":"üåô","02d":"üå§Ô∏è","02n":"üå•Ô∏è",
    "03d":"‚òÅÔ∏è","03n":"‚òÅÔ∏è","04d":"üå•Ô∏è","04n":"üå•Ô∏è",
    "09d":"üåßÔ∏è","09n":"üåßÔ∏è","10d":"üå¶Ô∏è","10n":"üåßÔ∏è",
    "11d":"‚õàÔ∏è","11n":"‚õàÔ∏è","13d":"‚ùÑÔ∏è","13n":"‚ùÑÔ∏è","50d":"üå´Ô∏è"
  };
  return icons[code.slice(0,2)+code.slice(2)]||'üå§Ô∏è';
}

function startAutoRefresh(){
  setInterval(()=>{
    if(radarData.coord){
      fetchMeteo(`lat=${radarData.coord.lat}&lon=${radarData.coord.lon}`);
    }
  },30000); // 30 secondi
}

function toggleFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen().catch(()=>null);
  }else document.exitFullscreen();
}

// Inizializzazioni canvas gi√† presenti...
function initRadarCanvas(){/* codice precedente migliorato */}
function drawMiniCharts(){/* grafici migliorati */}
</script>
</body>
</html>

